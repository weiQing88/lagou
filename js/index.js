var app=angular.module("app",["ui.router","ngCookies","validation"]).run(["$rootScope",function(t){t.init="run 初始化 rootScope 属性"}]);angular.module("app").config(["$validationProvider",function(t){var e={phone:/^1[\d]{10}/,password:function(t){return t.length>5},conformpw:function(t,e,a,n){return t===e.user.password1},sm:function(t){return!!t}},a={phone:{success:"",error:"必须是11位手机号"},password:{sccuess:"",error:"密码长度不能小于5"},conformpw:{success:"",error:"两次密码不一致"},sm:{success:"",error:"短息不能为空"}};t.setExpression(e).setDefaultMsg(a)}]),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("main",{url:"/main",templateUrl:"view/main.html",controller:"mainCtrl"}).state("position",{url:"/position/:id",templateUrl:"view/position.html",controller:"positionContrl"}).state("companyinfo",{url:"/companyinfo/:id",templateUrl:"view/companyinfo.html",controller:"companyinfo"}).state("search",{url:"/search",templateUrl:"view/search.html",controller:"searchCtrl"}).state("login",{url:"/login",templateUrl:"view/login.html",controller:"loginCtrl"}).state("registry",{url:"/registry",templateUrl:"view/registry.html",controller:"registryCtrl"}).state("post",{url:"/post",templateUrl:"view/post.html",controller:"postCtrl"}).state("favorite",{url:"/favorite",templateUrl:"view/favorite.html",controller:"favoriteCtrl"}).state("me",{url:"/me",templateUrl:"view/me.html",controller:"meCtrl"}),e.otherwise("main")}]),angular.module("app").controller("companyinfo",["$scope","$http","$q","cachefactory",function(t,e,a,n){t.companyinfo=null,e.get("./data/company.json?id=1").then(function(e){t.companyinfo=e.data})}]),angular.module("app").controller("favoriteCtrl",["$scope","$http",function(t,e){e.get("./data/myFavorite.json").then(function(e){t.list=e.data})}]),angular.module("app").controller("loginCtrl",["$scope","$http","cachefactory","$state",function(t,e,a,n){t.login=function(){e.get("./data/login.json").then(function(t){var e=t.data;e.id&&(a.put("userId",e.id),a.put("userName",e.name),a.put("userImage",e.image),n.go("me"))})}}]),angular.module("app").controller("mainCtrl",["$http","$scope",function(t,e){t.get("./data/positionList.json").then(function(t){e.list=t.data},function(t){})}]),angular.module("app").controller("meCtrl",["$scope","cachefactory","$state",function(t,e,a){t.haslogin=!1,e.get("userName")&&(t.haslogin=!0,t.name=e.get("userName"),t.img=e.get("userImage")),t.logout=function(){e.remove("userId"),e.remove("userName"),e.remove("userImage"),a.go("main")}}]),angular.module("app").controller("positionContrl",["$scope","$http","$state","$q","cachefactory",function(t,e,a,n,o){function i(a){var o=n.defer();return e.get("./data/position.json?id="+a).then(function(e){t.position=e.data,o.resolve(e.data.id)},function(t){o.reject(t)}),o.promise}function r(a){e.get("./data/company.json?id="+a).then(function(e){t.companyinfo=e.data},function(t){})}t.isLogin=!!o.get("userName"),t.position=null,t.companyinfo=null,e.get("./data/position.json?id="+a.params.id).then(function(e){t.position=e.data},function(t){}),i(a.params.id).then(function(t){r(t)})}]),angular.module("app").controller("postCtrl",["$scope","$http",function(t,e){t.tabList=[{id:"all",name:"全部"},{id:"pass",name:"面试邀请"},{id:"fail",name:"不合适"}],e.get("./data/myPost.json").then(function(e){t.list=e.data}),t.filterId={},t.tabcback=function(e,a){switch(e){case"all":delete t.filterId.state;break;case"pass":t.filterId.state="1";break;case"fail":t.filterId.state="-1"}}}]),angular.module("app").controller("registryCtrl",["$scope","$http","$interval","$state",function(t,e,a,n){t.registry=function(){e.get("./data/registry.json").then(function(t){t.data.id&&n.go("login")})},t.send=function(){t.time="60s",e.get("./data/code.json").then(function(e){var n=e.data,o=10;if(1===n.state)var i=a(function(){return o--,o<=0?(a.cancel(i),t.time="",!1):void(t.time=o+"s")},1e3)})}}]),angular.module("app").controller("searchCtrl",["$scope","$http","dict",function(t,e,a){t.positionList=null,t.name="",t.search=function(){e.get("/data/positionList.json?name="+t.name).then(function(e){t.positionList=e.data})},t.search(),t.tabList=[{id:"city",name:"城市"},{id:"salary",name:"薪水"},{id:"scale",name:"公司规模"}],t.filterId={},t.sheet={};var n="";t.tabcback=function(e,o){n=e,t.sheet.list=a[e],t.sheet.visible=!0},t.sClick=function(e,a){e?(angular.forEach(t.tabList,function(t){t.id===n&&(t.name=a)}),t.filterId[n+"Id"]=e):angular.forEach(t.tabList,function(e){switch(e.id){case"city":e.name="城市",delete t.filterId[e.id+"Id"];break;case"salary":e.name="薪水",delete t.filterId[e.id+"Id"];break;case"scale":e.name="公司规模",delete t.filterId[e.id+"Id"]}})}}]),angular.module("app").directive("appHeadBar",[function(){return{restrict:"A",replace:!0,templateUrl:"view/templates/headBar.html",scope:{text:"@"},link:function(t){t.back=function(){window.history.back()}}}}]),angular.module("app").directive("appCompany",[function(){return{restrict:"A",replace:!0,templateUrl:"view/templates/company.html",scope:{com:"="}}}]),angular.module("app").directive("appFooter",[function(){return{restrict:"A",replace:!0,templateUrl:"view/templates/foot.html"}}]),angular.module("app").directive("appHead",["cachefactory",function(t){return{restrict:"A",replace:!0,templateUrl:"view/templates/heade.html",link:function(e){t.get("userName")&&(e.name="你好，"+t.get("userName"))}}}]),angular.module("app").directive("appPositionClass",[function(){return{restrict:"A",replace:!0,templateUrl:"view/templates/position.class.html",scope:{com:"="},link:function(t){t.showPositionList=function(e){t.positionList=t.com.positionClass[e].positionList,t.isActived=e};t.$watch("com",function(e,a,n){e&&t.showPositionList(0)})}}}]),angular.module("app").directive("appPositionList",["cachefactory","$http",function(t,e){return{restrict:"A",replace:!0,templateUrl:"view/templates/position.list.html",scope:{data:"=",filterId:"="},link:function(a){a.name=t.get("userName"),a.selected=function(t){e.get("./data/favorite.json").then(function(e){t.select=!t.select})}}}}]),angular.module("app").directive("appPositionInfo",["cachefactory",function(t){return{restrict:"A",replace:!0,templateUrl:"view/templates/positioninfo.html",scope:{isLogin:"=",pos:"="},link:function(t){var e=!1;t.imgPath="imgs/star.png",t.fav=function(){e=!e,t.imgPath=e?"imgs/star-active.png":"imgs/star.png"}}}}]),angular.module("app").directive("appSearchTab",[function(){return{restrict:"A",replace:!0,templateUrl:"view/templates/search-tab.html",scope:{list:"=",tClick:"&"},link:function(t){t.selectedId="",t.selectedtab=function(e){t.tClick(e),t.selectedId=e.id}}}}]),angular.module("app").directive("appSheet",[function(){return{restrict:"A",replace:!0,templateUrl:"view/templates/sheet.html",scope:{visible:"=",list:"=",selected:"&"},link:function(t){t.selectedItem=function(e){t.selected(e)}}}}]),angular.module("app").factory("cachefactory",["$cookies",function(t){return{put:function(e,a){t.put(e,a)},get:function(e){return t.get(e)},remove:function(e){t.remove(e)}}}]),angular.module("app").value("dict",{}).run(["$http","dict",function(t,e){t.get("./data/city.json").then(function(t){e.city=t.data}),t.get("./data/salary.json").then(function(t){e.salary=t.data}),t.get("./data/scale.json").then(function(t){e.scale=t.data})}]),angular.module("app").filter("filterList",function(){return function(t,e){var a=[];return angular.forEach(t,function(t){var n=!0;for(var o in e)n=t[o]===e[o];n&&a.push(t)}),a}});
